import sys

def hash_string(buffer):
    local_2 = 0
    local_1 = 16
    for x in buffer:
        v2 = local_2
        local_1 = 16
        v3 = (local_2 << 6)&0xffffffff
        v4 = local_2
        local_2 = ord(x)
        local_2 = (local_2 + v3) & 0xffffffff
        local_2 = (local_2 + (v4 << 16)) & 0xffffffff
        local_2 = (local_2 - v2)&0xffffffff
    return local_2 ^ 0x3BA6FA64

#print(hex(hash_string("GetProcessHeap")))
with open(sys.argv[1], "r") as f:
    for x in f:
        api = x.strip()
        print("\tEMOTET_API_HASH_{}={},".format(api, hex(hash_string(api))))
